<script>
//navigator.nfc.watch(message => {
//     for (let record of message.data) {
//         console.log(record.data);
//         let name = record.data.name;
////                                                              this.onItemReceived(name);
//                                                                           }
//}, { mode: "any", recordType: "json" });




navigator.nfc.watch((message) => {
  if (message.data[0].recordType == 'empty') {
    navigator.nfc.push({
      url: "/custom/path",
      data: [{ recordType: "text", data: 'Hello World' }]
    });
  } else {
    console.log('Read message written by ' + message.url);
    processMessage(message);
  }
}).then(() => {
  console.log("Added a watch.");
}).catch((error) => {
  console.log("Adding watch failed: " + error.name);
});

function processMessage(message) {
  for (let record of message.data) {
    switch (record.recordType) {
      case "text":
        console.log('Data is text: ' + record.data);
        break;
      case "url":
        console.log('Data is URL: ' + record.data);
        break;
      case "json":
        console.log('JSON data: ' + record.data.myProperty.toString());
        break;
      case "opaque":
        if (record.mediaType == 'image/png') {
          var img = document.createElement("img");
          img.src = URL.createObjectURL(new Blob(record.data, record.mediaType));
          img.onload = function() {
            window.URL.revokeObjectURL(this.src);
          };
        }
        break;
    }
  }
}

</script>
