<!doctype html>
<html>
<head>
<meta charset=utf-8>
<title>web nfc</title>
<link rel="author" title="Harald Alvestrand" href="mailto:hta@google.com"/>
<link rel="help" href="http://w3c.github.io/webrtc-pc/#rtcpeerconnection-interface">
</head>
<body>

<h1 class="instructions">Description</h1>
<p class="instructions">This test verifies the availability of the RTCPeerConnection interface.</p>
<div id='log'></div>
<script src=./../resources/testharness.js></script>
<script src=./../resources/testharnessreport.js></script>
<script src=./../resources/WebIDLParser.js></script>
<script src=./../resources/idlharness.js></script>

<!-- The IDL is copied from the 22 September 2015 editors' draft. -->
<script type="text/plain">
interface Navigator{
    // Only a dummy definition is needed here.
};
enum NFCRecordType {
    "empty",
    "text",
    "url",
    "json",
    "opaque"
};
typedef (DOMString or unrestricted double or ArrayBuffer or Dictionary) NFCRecordData;
dictionary NFCRecord {
    NFCRecordType recordType;
    USVString     mediaType;
    NFCRecordData data;
};
dictionary NFCMessage {
    sequence<NFCRecord> data;
    USVString           url;
};
partial interface Navigator {
    readonly attribute NFC nfc;
};
typedef (DOMString or ArrayBuffer or NFCMessage) NFCPushMessage;
interface NFC {
    Promise<void> push(NFCPushMessage message, optional NFCPushOptions options);
    Promise<void> cancelPush(optional NFCPushTarget target = "any");
    Promise<long> watch(MessageCallback callback,
                        optional NFCWatchOptions options);
    Promise<void> cancelWatch(optional long id);
};
callback MessageCallback = void (NFCMessage message);
enum NFCPushTarget {
    "tag",
    "peer",
    "any"
};
dictionary NFCPushOptions {
    NFCPushTarget       target = "any";
    unrestricted double timeout = Infinity;
    boolean             ignoreRead = true;
};
enum NFCWatchMode {
    "web-nfc-only",
    "any"
};
dictionary NFCWatchOptions {
    USVString      url = "";
    NFCRecordType? recordType;
    USVString      mediaType = "";
    NFCWatchMode   mode = "web-nfc-only";
};

</script>
<script>
(function() {
  var idl_array = new IdlArray();
  [].forEach.call(document.querySelectorAll("script[type=text\\/plain]"),
                  function(node) {
                    idl_array.add_idls(node.textContent);
                  });
  window.pc = new RTCPeerConnection(null);
  idl_array.add_objects({"RTCPeerConnection": ["pc"]});
  idl_array.test();
  done();
})();
</script>
</body>
</html>
